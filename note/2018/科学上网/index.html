<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-02-04 Tue 00:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>科学上网</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Yuan Fu" />
<link rel="stylesheet" type="text/css" href="../../style.css"/>
<script type="text/javascript" src="../../script.js"></script>
<link rel="icon" type="image/png" href="../../../favicon.png">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../../index.html"> UP </a>
 |
 <a accesskey="H" href="../../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">科学上网</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgcf684f6">1. 安装之前</a>
<ul>
<li><a href="#orgd5e519b">1.1. 查询时间</a></li>
</ul>
</li>
<li><a href="#org02ef434">2. 配置</a>
<ul>
<li><a href="#orge00ed44">2.1. 客户端配置</a></li>
<li><a href="#orgfb0461d">2.2. UUID</a></li>
<li><a href="#org013127b">2.3. 服务器配置</a></li>
<li><a href="#org13fbfbc">2.4. 日志配置</a></li>
</ul>
</li>
<li><a href="#org083e444">3. 运行</a>
<ul>
<li><a href="#org1e072d7">3.1. Arch 服务器</a></li>
<li><a href="#org6303443">3.2. Mac客户端</a></li>
<li><a href="#org55892b0">3.3. iOS客户端</a></li>
<li><a href="#org60f18b4">3.4. 安卓客户端</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
一些笔记
</p>

<hr />

<p>
软件：<a href="https://github.com/v2ray">V2ray</a>
</p>

<p>
教程资源：<a href="https://toutyrater.github.io">V2Ray 配置指南</a>。作者文笔不错，解释清晰易懂。
</p>

<p>
<a href="https://www.v2ray.com/developer/protocols/vmess.html">☞ 官方文档</a>
</p>

<div id="outline-container-orgcf684f6" class="outline-2">
<h2 id="orgcf684f6"><span class="section-number-2">1</span> 安装之前</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgd5e519b" class="outline-3">
<h3 id="orgd5e519b"><span class="section-number-3">1.1</span> 查询时间</h3>
<div class="outline-text-3" id="text-1-1">
<p>
V2ray要求客户端与服务端时间相差2分钟以内（自动转化时区）。
</p>
<div class="org-src-container">
<pre class="src src-shell">date -R
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org02ef434" class="outline-2">
<h2 id="org02ef434"><span class="section-number-2">2</span> 配置</h2>
<div class="outline-text-2" id="text-2">
<p>
从配置指南和官方文档中复制而来，有一些修改。
</p>
</div>
<div id="outline-container-orge00ed44" class="outline-3">
<h3 id="orge00ed44"><span class="section-number-3">2.1</span> 客户端配置</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-javascript">{
  <span style="color: #50a14f;">"inbounds"</span>: [
    {
      <span style="color: #50a14f;">"port"</span>: 1080, <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#23458;&#25143;&#31471;&#30340;&#31471;&#21475;</span>
      <span style="color: #50a14f;">"protocol"</span>: <span style="color: #50a14f;">"socks"</span>, <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#20837;&#21475;&#21327;&#35758;&#20026; SOCKS 5</span>
      <span style="color: #50a14f;">"domainOverride"</span>: [<span style="color: #50a14f;">"tls"</span>,<span style="color: #50a14f;">"http"</span>],
      <span style="color: #50a14f;">"settings"</span>: {
        <span style="color: #50a14f;">"auth"</span>: <span style="color: #50a14f;">"noauth"</span>  <span style="color: #9ca0a4;">//</span><span style="color: #9ca0a4;">socks&#30340;&#35748;&#35777;&#35774;&#32622;&#65292;noauth &#20195;&#34920;&#19981;&#35748;&#35777;&#65292;&#30001;&#20110; socks &#36890;&#24120;&#22312;&#23458;&#25143;&#31471;&#20351;&#29992;&#65292;&#25152;&#20197;&#36825;&#37324;&#19981;&#35748;&#35777;</span>
      }
    }
  ],
  <span style="color: #50a14f;">"outbounds"</span>: [
    {
      <span style="color: #50a14f;">"protocol"</span>: <span style="color: #50a14f;">"vmess"</span>, <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#20986;&#21475;&#21327;&#35758;</span>
      <span style="color: #50a14f;">"settings"</span>: {
        <span style="color: #50a14f;">"vnext"</span>: [
          {
            <span style="color: #50a14f;">"address"</span>: <span style="color: #50a14f;">"serveraddr.com"</span>, <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#26381;&#21153;&#22120;&#22320;&#22336;&#65292;&#19968;&#33324;&#20026;IP&#22320;&#22336;</span>
            <span style="color: #50a14f;">"port"</span>: 16823,  <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#26381;&#21153;&#22120;&#31471;&#21475;</span>
            <span style="color: #50a14f;">"users"</span>: [
              {
                <span style="color: #50a14f;">"id"</span>: <span style="color: #50a14f;">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,  <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#29992;&#25143; ID&#65292;&#24517;&#39035;&#19982;&#26381;&#21153;&#22120;&#31471;&#37197;&#32622;&#30456;&#21516;</span>
                <span style="color: #50a14f;">"alterId"</span>: 64 <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#27492;&#22788;&#30340;&#20540;&#20063;&#24212;&#24403;&#19982;&#26381;&#21153;&#22120;&#30456;&#21516;</span>
              }
            ]
          }
        ]
      }
    }
  ]
}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfb0461d" class="outline-3">
<h3 id="orgfb0461d"><span class="section-number-3">2.2</span> UUID</h3>
<div class="outline-text-3" id="text-2-2">
<p>
生成uuid。uuid承担类似密码的功能。
</p>

<div class="org-src-container">
<pre class="src src-shell">/proc/sys/kernel/random/uuid
</pre>
</div>
</div>
</div>

<div id="outline-container-org013127b" class="outline-3">
<h3 id="org013127b"><span class="section-number-3">2.3</span> 服务器配置</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-javascript">{
  <span style="color: #50a14f;">"inbounds"</span>: [
    {
      <span style="color: #50a14f;">"port"</span>: 16823, <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#26381;&#21153;&#22120;&#30417;&#21548;&#31471;&#21475;</span>
      <span style="color: #50a14f;">"protocol"</span>: <span style="color: #50a14f;">"vmess"</span>,    <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#20027;&#20256;&#20837;&#21327;&#35758;</span>
      <span style="color: #50a14f;">"settings"</span>: {
        <span style="color: #50a14f;">"clients"</span>: [
          {
            <span style="color: #50a14f;">"id"</span>: <span style="color: #50a14f;">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,  <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#29992;&#25143; ID&#65292;&#23458;&#25143;&#31471;&#19982;&#26381;&#21153;&#22120;&#24517;&#39035;&#30456;&#21516;</span>
            <span style="color: #50a14f;">"alterId"</span>: 64
          }
        ]
      }
    }
  ],
  <span style="color: #50a14f;">"outbounds"</span>: [
    {
      <span style="color: #50a14f;">"protocol"</span>: <span style="color: #50a14f;">"freedom"</span>,  <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#20027;&#20256;&#20986;&#21327;&#35758;</span>
      <span style="color: #50a14f;">"settings"</span>: {}
    }
  ]
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org13fbfbc" class="outline-3">
<h3 id="org13fbfbc"><span class="section-number-3">2.4</span> 日志配置</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-javascript">{
  <span style="color: #50a14f;">"log"</span>: {
    <span style="color: #50a14f;">"loglevel"</span>: <span style="color: #50a14f;">"warning"</span>, <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#26085;&#24535;&#32423;&#21035;</span>
    <span style="color: #50a14f;">"access"</span>: <span style="color: #50a14f;">"D:\\v2ray\\access.log"</span>,  <span style="color: #9ca0a4;">// </span><span style="color: #9ca0a4;">&#36825;&#26159; Windows &#31995;&#32479;&#30340;&#36335;&#24452;</span>
    <span style="color: #50a14f;">"error"</span>: <span style="color: #50a14f;">"D:\\v2ray\\error.log"</span>
  },
}
</pre>
</div>

<p>
引用自配置指南：
</p>

<blockquote>
<p>
loglevel：日志级别，分别有5个，本例中设定的是 warning
</p>

<p>
debug：最详细的日志信息，专用于软件调试
</p>

<p>
info：比较详细的日志信息，可以看到 V2Ray 详细的连接信息
</p>

<p>
warning：警告信息。轻微的问题信息，经我观察 warning 级别的信息大多是网络错误。推荐使用 warning
</p>

<p>
error：错误信息。比较严重的错误信息。当出现 error 时该问题足以影响 V2Ray 的正常运行
</p>

<p>
none：空。不记录任何信息
</p>

<p>
access：将访问的记录保存到文件中，这个选项的值是要保存到的文件的路径
</p>

<p>
error：将错误的记录保存到文件中，这个选项的值是要保存到的文件的路径
</p>

<p>
error、access 字段留空，并且在手动执行 V2Ray 时，V2Ray 会将日志输出在 stdout 即命令行中（terminal、cmd 等），便于排错
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-org083e444" class="outline-2">
<h2 id="org083e444"><span class="section-number-2">3</span> 运行</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org1e072d7" class="outline-3">
<h3 id="org1e072d7"><span class="section-number-3">3.1</span> Arch 服务器</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<code>systemd</code> 默认的配置文件地址在 <code>/etc/v2ray/config.json</code> 。 软链接或者直接修改文件。
</p>

<p>
开启/运行用 <code>systemd</code> 就好：
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl start/stop/restart v2ray
systemctl status v2ray
</pre>
</div>
</div>
</div>

<div id="outline-container-org6303443" class="outline-3">
<h3 id="org6303443"><span class="section-number-3">3.2</span> Mac客户端</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Homebrew的v2ray叫v2ray-core。安装以后默认的配置文件地址在 <code>/usr/local/etc/v2ray/config.json</code> ，同样，软链接或者直接替换文件都可以。
因为配置文件在默认地址，启动只需要
</p>
<div class="org-src-container">
<pre class="src src-shell">brew services start v2ray-core
</pre>
</div>
<p>
并且之后会开机自动运行。
</p>

<p>
打开System Preference - Network - Location （顶部） - Edit Locations，
添加一个VPN的location。这样之后可以在顶部状态栏快速切换VPN和直连（最左Apple图标 -
Locaion）。
</p>

<p>
在新的Location里打开Advanced - Proxies - SOCKS5 Proxy - SOCKS5 Proxy Server，按Mac客户端的配置文件填，之前的例子里是 <code>127.0.0.1:16823</code> 。IP地址 <code>127.0.0.1</code> 一般不会变，改端口号就可以。
</p>

<p>
修改完成后保存。启动客户端并把Location改为新的就可以科学上网了。
</p>
</div>
</div>

<div id="outline-container-org55892b0" class="outline-3">
<h3 id="org55892b0"><span class="section-number-3">3.3</span> iOS客户端</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Kitsunebi Lite，手动配置地址，端口和UUID，其他保持默认即可。
</p>

<p>
<b><span class="timestamp-wrapper"><span class="timestamp">&lt;2019-05-19 Sun&gt; </span></span> 更新</b> ：Kitsunebi Lite下架又上了一个$5的Kitsunebi，太坑爹，现在建议用Shadowrocket，图标是小火箭。
</p>
</div>
</div>

<div id="outline-container-org60f18b4" class="outline-3">
<h3 id="org60f18b4"><span class="section-number-3">3.4</span> 安卓客户端</h3>
<div class="outline-text-3" id="text-3-4">
<p>
<a href="https://github.com/2dust/v2rayNG/releases">V2rayNG</a>，配置方法和iOS一样。
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2018-12-01 Sat 19:28</p>
<p class="author">Author: Yuan Fu</p>
<p class="date">Created: 2020-02-04 Tue 00:11</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
