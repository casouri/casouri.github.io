<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2018-12-22 Sat 19:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>科学上网</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Yuan Fu" />
<link rel="stylesheet" type="text/css" href="../../style.css"/>
<script type="text/javascript" src="../../script.js"></script>
<link rel="icon" type="image/png" href="../../../favicon.png">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up-index-page">
<div>
<a accesskey="h" href="../../index.html"> UP </a> |
<a accesskey="H" href="../../index.html"> HOME </a>
</div>
<div>
<a href="./index.xml"> RSS </a> |
<a href="https://github.com/casouri/casouri.github.io"> Source </a> |
<a href="https://creativecommons.org/licenses/by-sa/4.0/"> License </a>
</div>
</div><div id="content">
<h1 class="title">科学上网</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgcafcd83">1. 安装之前</a>
<ul>
<li><a href="#org831ec5e">1.1. 查询时间</a></li>
</ul>
</li>
<li><a href="#orgdb858cc">2. 配置</a>
<ul>
<li><a href="#org1ae6a53">2.1. 客户端配置</a></li>
<li><a href="#org91b4f29">2.2. UUID</a></li>
<li><a href="#orgaaa26cd">2.3. 服务器配置</a></li>
<li><a href="#org5d5c2fc">2.4. 日志配置</a></li>
</ul>
</li>
<li><a href="#orgc01cf33">3. 运行</a>
<ul>
<li><a href="#org0ff3e5a">3.1. Arch 服务器</a></li>
<li><a href="#org474dd53">3.2. Mac客户端</a></li>
<li><a href="#org8861c9e">3.3. iOS客户端</a></li>
<li><a href="#org69f11e1">3.4. 安卓客户端</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
一些笔记
</p>

<hr />

<p>
软件：<a href="https://github.com/v2ray">V2ray</a>
</p>

<p>
教程：<a href="https://toutyrater.github.io">V2Ray 配置指南</a>。作者文笔不错，解释清晰易懂。
</p>

<p>
<a href="https://www.v2ray.com/developer/protocols/vmess.html">VMess协议</a>
</p>

<div id="outline-container-orgcafcd83" class="outline-2">
<h2 id="orgcafcd83"><span class="section-number-2">1</span> 安装之前</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org831ec5e" class="outline-3">
<h3 id="org831ec5e"><span class="section-number-3">1.1</span> 查询时间</h3>
<div class="outline-text-3" id="text-1-1">
<p>
V2ray要求客户端与服务端时间相差2分钟以内（自动转化时区）。
</p>
<div class="org-src-container">
<pre class="src src-shell">date -R
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdb858cc" class="outline-2">
<h2 id="orgdb858cc"><span class="section-number-2">2</span> 配置</h2>
<div class="outline-text-2" id="text-2">
<p>
从配置指南和官方文档中复制而来，有一些修改。
</p>
</div>
<div id="outline-container-org1ae6a53" class="outline-3">
<h3 id="org1ae6a53"><span class="section-number-3">2.1</span> 客户端配置</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-json">{
  "inbounds": [
    {
      "port": 1080, // 客户端的端口
      "protocol": "socks", // 入口协议为 SOCKS 5
      "domainOverride": ["tls","http"],
      "settings": {
        "auth": "noauth"  //socks的认证设置，noauth 代表不认证，由于 socks 通常在客户端使用，所以这里不认证
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "vmess", // 出口协议
      "settings": {
        "vnext": [
          {
            "address": "serveraddr.com", // 服务器地址，一般为IP地址
            "port": 16823,  // 服务器端口
            "users": [
              {
                "id": "b831381d-6324-4d53-ad4f-8cda48b30811",  // 用户 ID，必须与服务器端配置相同
                "alterId": 64 // 此处的值也应当与服务器相同
              }
            ]
          }
        ]
      }
    }
  ]
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org91b4f29" class="outline-3">
<h3 id="org91b4f29"><span class="section-number-3">2.2</span> UUID</h3>
<div class="outline-text-3" id="text-2-2">
<p>
生成uuid。uuid承担类似密码的功能。
</p>

<div class="org-src-container">
<pre class="src src-shell">/proc/sys/kernel/random/uuid
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaaa26cd" class="outline-3">
<h3 id="orgaaa26cd"><span class="section-number-3">2.3</span> 服务器配置</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-json">{
  "inbounds": [
    {
      "port": 16823, // 服务器监听端口
      "protocol": "vmess",    // 主传入协议
      "settings": {
        "clients": [
          {
            "id": "b831381d-6324-4d53-ad4f-8cda48b30811",  // 用户 ID，客户端与服务器必须相同
            "alterId": 64
          }
        ]
      }
    }
  ],
  "outbounds": [
    {
      "protocol": "freedom",  // 主传出协议
      "settings": {}
    }
  ]
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org5d5c2fc" class="outline-3">
<h3 id="org5d5c2fc"><span class="section-number-3">2.4</span> 日志配置</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-json">{
  "log": {
    "loglevel": "warning", // 日志级别
    "access": "D:\\v2ray\\access.log",  // 这是 Windows 系统的路径
    "error": "D:\\v2ray\\error.log"
  },
}
</pre>
</div>

<blockquote>
<p>
loglevel：日志级别，分别有5个，本例中设定的是 warning
</p>

<p>
debug：最详细的日志信息，专用于软件调试
</p>

<p>
info：比较详细的日志信息，可以看到 V2Ray 详细的连接信息
</p>

<p>
warning：警告信息。轻微的问题信息，经我观察 warning 级别的信息大多是网络错误。推荐使用 warning
</p>

<p>
error：错误信息。比较严重的错误信息。当出现 error 时该问题足以影响 V2Ray 的正常运行
</p>

<p>
none：空。不记录任何信息
</p>

<p>
access：将访问的记录保存到文件中，这个选项的值是要保存到的文件的路径
</p>

<p>
error：将错误的记录保存到文件中，这个选项的值是要保存到的文件的路径
</p>

<p>
error、access 字段留空，并且在手动执行 V2Ray 时，V2Ray 会将日志输出在 stdout 即命令行中（terminal、cmd 等），便于排错
</p>
</blockquote>
</div>
</div>
</div>

<div id="outline-container-orgc01cf33" class="outline-2">
<h2 id="orgc01cf33"><span class="section-number-2">3</span> 运行</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org0ff3e5a" class="outline-3">
<h3 id="org0ff3e5a"><span class="section-number-3">3.1</span> Arch 服务器</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<code>systemd</code> 默认的配置文件地址在 <code>/etc/v2ray/config.json</code> 。 软链接或者直接修改文件。
</p>

<p>
开启/运行用 <code>systemd</code> 就好：
</p>
<div class="org-src-container">
<pre class="src src-shell">systemctl start/stop/restart v2ray
systemctl status v2ray
</pre>
</div>
</div>
</div>

<div id="outline-container-org474dd53" class="outline-3">
<h3 id="org474dd53"><span class="section-number-3">3.2</span> Mac客户端</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Homebrew的v2ray叫v2ray-core。安装以后默认的配置文件地址在 <code>/usr/local/etc/v2ray/config.json</code> ，同样，软链接或者直接替换文件都可以。
</p>
</div>
</div>

<div id="outline-container-org8861c9e" class="outline-3">
<h3 id="org8861c9e"><span class="section-number-3">3.3</span> iOS客户端</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Kitsunebi Lite，手动配置地址，端口和UUID，其他保持默认即可。
</p>
</div>
</div>

<div id="outline-container-org69f11e1" class="outline-3">
<h3 id="org69f11e1"><span class="section-number-3">3.4</span> 安卓客户端</h3>
<div class="outline-text-3" id="text-3-4">
<p>
<a href="https://github.com/2dust/v2rayNG/releases">V2rayNG</a>，配置方法和iOS一样。
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Written by Yuan Fu <<a href="mailto:casouri@gmail.com">casouri@gmail.com</a>></p>
<p class="first-publish">First Published on 2018-12-01 Sat 19:28</p>
<p class-"last-modified">Last modified on 2018-12-22 Sat 19:54</p>
</div>
</body>
</html>
