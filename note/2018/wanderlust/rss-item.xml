<item>
<title>Wanderlust</title>
<link>https://archive.casouri.cat/note/2018/wanderlust</link>
<guid>https://archive.casouri.cat/note/2018/wanderlust</guid>
<description><![CDATA[<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#References">1. References</a></li>
<li><a href="#Install">2. Install</a></li>
<li><a href="#Receive-Mail">3. Receive Mail</a></li>
<li><a href="#Folder-Buffer">4. Folder Buffer</a></li>
<li><a href="#Summary-Buffer">5. Summary Buffer</a></li>
<li><a href="#Send-Mail">6. Send Mail</a></li>
<li><a href="#Address-Book">7. Address Book</a></li>
<li><a href="#Search-Mail">8. Search Mail</a></li>
<li><a href="#Auto-Refile">9. Auto Refile</a></li>
<li><a href="#Expire-rules">10. Expire rules</a></li>
<li><a href="#Other">11. Other</a></li>
<li><a href="#Funny-Quote">12. Funny Quote</a></li>
</ul>
</div>
</div>
<p>
Wanderlust is a Emacs email client, I have had enough with Thunderbird and Mail on macOS (Thunderbird uses a ton of RAM and Mail got werid bugs that no one except me seems have encountered, and both of them sucks at searching mails), and apparently Outlook doesn't work on mac, so I'm finally getting my hand dirty with Emacs email client.
</p>

<div id="outline-container-References" class="outline-2">
<h2 id="References"><span class="section-number-2">1</span> References</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://github.com/LdBeth/Emacs-for-Noobs/blob/master/WanderLust.org">LdBeth's tutorial</a>
</p>

<p>
<a href="https://www.emacswiki.org/emacs/WanderLust">EmacsWiki</a>
</p>

<p>
<a href="https://www.emacswiki.org/emacs/WlFaq">EmacsWiki FAQ</a>
</p>

<p>
<a href="http://wanderlust.github.io/wl-docs/wl.html">Manual</a>
</p>

<p>
<a href="http://dis-dot-dat.blogspot.com/2010/04/ive-used-combination-of-mutt-emacs.html">Some good snippets</a>
</p>
</div>
</div>

<div id="outline-container-Install" class="outline-2">
<h2 id="Install"><span class="section-number-2">2</span> Install</h2>
<div class="outline-text-2" id="text-2">
<p>
You need APEL, FLIM/CLIME, SEMI, in that order, and, of course, wanderlust.
</p>

<p>
I installed them with my cowboy.el (in the brute force manner), you can just install from melpa.
</p>
</div>
</div>

<div id="outline-container-Receive-Mail" class="outline-2">
<h2 id="Receive-Mail"><span class="section-number-2">3</span> Receive Mail</h2>
<div class="outline-text-2" id="text-Receive-Mail">
</div>
<div id="outline-container-Folder" class="outline-3">
<h3 id="Folder"><span class="section-number-3">3.1</span> Folder</h3>
<div class="outline-text-3" id="text-3-1">
<p>
First, config file is <code>~/.folders</code>, you can change it by <code>wl-folders-file</code>. Here you setup "folders", for wanderlust there is only folder, no account.
</p>

<p>
<a href="http://mihai.bazon.net/articles/emacs/wanderlust-email-client/configure-email-folders">Mishoo</a> has a detailed and helpful explanation of this, but for archiving purpose I'll repeat him below.
</p>

<blockquote>
<p>
WL stores the folders information in the file “$HOME/.folders” (dot folders).  Here's the syntax for one IMAP folder:
</p>

<p>
%INBOX:johndoe/clear@mail.domain.com:993!   "INBOX"
</p>

<p>
The above tells WL that we have an IMAP folder (starts with “%”), on the server named “mail.domain.com”, using “clear” (plain) authentication, user name “johndoe”, port “993” and should use secure sockets layer (SSL) when connecting (ends with “!”).  Additionally, the string "INBOX" at the end specifies how this folder should be named locally.
</p>
</blockquote>

<p>
P.S. <code>%</code> is IMAP folder, <code>+</code> is local folder, other folders see <a href="http://wanderlust.github.io/wl-docs/wl.html#Folders">the manual</a>.
</p>
</div>
</div>

<div id="outline-container-Grouping" class="outline-3">
<h3 id="Grouping"><span class="section-number-3">3.2</span> Grouping</h3>
<div class="outline-text-3" id="text-3-2">
<p>
A single folder is not very useful, here is how to setup groups in WL:
</p>

<div class="org-src-container">
<pre class="src src-unix-config">GMAIL {
   %Inbox:casouri/clear@imap.gmail.com:993!             "Inbox"
   %[Gmail]/All Mail:casouri/clear@imap.gmail.com:993!  "All Mail"
   %[Gmail]/Sent Mail:casouri/clear@imap.gmail.com:993! "Sent"
   %[Gmail]/Starred:casouri/clear@imap.gmail.com:993!   "Starred"
   %[Gmail]/Drafts:casouri/clear@imap.gmail.com:993!    "Draft"
   %[Gmail]/Trash:casouri/clear@imap.gmail.com:993!     "Trash"
}
</pre>
</div>

<p>
And it looks like this in WL:
</p>

<pre class="example">
[-]Desktop:0/37/24319
  [-]GMAIL :0/37/24319
    Inbox:0/0/2
    All Mail:0/0/544
    Sent:0/0/304
    Starred:0/0/1
    Draft:0/0/0
    Trash:0/37/23468
</pre>

<p>
(The <code>Desktop</code> can be changed by variable <code>wl-folder-desktop-name</code>)
</p>

<p>
It took me a while to sync up the labels in Gmail and my local WL folders.
</p>

<p>
The part <code>[Gmail]/All Mail</code> is the folder (label in Gmail). I thought that the <code>[Gmail]</code> is some sort of special syntax, turns out it's just how Google name their system labels (folders) in Gmail.
</p>

<p>
Also you need to make sure you have made these system labels available to SMTP:
</p>


<div id="org8970957" class="figure">
<p><img src="/note/2018/wanderlust/label-setting.png" alt="label-setting.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-update:-Use-%3Ccode%3Efetchmail%3C/code%3E-to-Download-Mails" class="outline-3">
<h3 id="update:-Use-%3Ccode%3Efetchmail%3C/code%3E-to-Download-Mails"><span class="section-number-3">3.3</span> Update: Use <code>fetchmail</code> to Download Mails</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Not downloading the mail until I read it sound silly, it's not like I don't read every mail&#x2026; Plus WL is super slow when fetching mails when I open each mail.
</p>
</div>

<div id="outline-container-What-You-Need" class="outline-4">
<h4 id="What-You-Need"><span class="section-number-4">3.3.1</span> What You Need</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
<code>fetchmail</code> and <code>postfix</code>.
</p>
</div>
</div>

<div id="outline-container-%3Ccode%3Efetchmail%3C/code%3E" class="outline-4">
<h4 id="%3Ccode%3Efetchmail%3C/code%3E"><span class="section-number-4">3.3.2</span> <code>fetchmail</code></h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
<a href="http://www.fetchmail.info/fetchmail-man.html">fetchmail manual</a>
</p>

<p>
<a href="https://www.linode.com/docs/email/clients/using-fetchmail-to-retrieve-email/">a tutorial</a>
</p>

<p>
Configure <code>fetchmail</code> with <code>~/.fetchmailrc</code>.
</p>

<p>
In the following line:
</p>

<div class="org-src-container">
<pre class="src src-shell">poll imap.gmail.com protocol IMAP auth password
    user <span style="color: #489446;">"apprentice@gmail.com"</span> is apprentice here
    password <span style="color: #489446;">'klwpcmaqeycndist'</span>
    ssl, sslcertck, idle
</pre>
</div>

<p>
(Note: If I use <code>set deamon 60</code>, fetchmail cannot resolve DNS correctly.)
</p>

<p>
Then change <code>.folder</code> file:
</p>

<div class="org-src-container">
<pre class="src src-unix-config">GMAIL {
   .inbox             "Inbox"
}
</pre>
</div>

<p>
<code>.</code> means <a href="https://en.wikipedia.org/wiki/Maildir">maildir format</a>.
</p>
</div>
</div>

<div id="outline-container-%3Ccode%3Epostfix%3C/code%3E" class="outline-4">
<h4 id="%3Ccode%3Epostfix%3C/code%3E"><span class="section-number-4">3.3.3</span> <code>postfix</code></h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
Open <code>/etc/postfix/main.cf</code>, Add/ucomment there lines:
</p>

<pre class="example">
home_mailbox = Maildir/
mailbox_command =
</pre>

<p>
Also make sure <code>inet_interface</code> is set to <code>loopback-only</code> (127.0.0.1):
</p>

<pre class="example">
inet_interfaces = loopback-only
</pre>

<p>
So you don't listen to mail comes from places other than <code>fetchmail</code>.
</p>

<p>
Note that <code>postfix</code> choses mail format between mailbox and maildir depends on whether <code>home_mailbox</code>
is a directory or a file (the slash). The name of the directory (or file) can be changed how ever you like.
</p>
</div>
</div>

<div id="outline-container-Use-%3Ccode%3Eprocmail%3C/code%3E-to-replace-%3Ccode%3Epostfix%3C/code%3E" class="outline-4">
<h4 id="Use-%3Ccode%3Eprocmail%3C/code%3E-to-replace-%3Ccode%3Epostfix%3C/code%3E"><span class="section-number-4">3.3.4</span> Use <code>procmail</code> to replace <code>postfix</code></h4>
<div class="outline-text-4" id="text-3-3-4">
<p>
For some reason I cannot start <code>postfix</code> on my machine. This might be another culprit of macOS Mojave&#x2026;
</p>

<p>
Anyway, I then replaced it with <code>procmail</code>.
</p>

<p>
First change the <code>.fetchmailrc</code> to make it use another MDA:
</p>

<pre class="example">
mda '/usr/local/bin/procmail ~/.procmailrc'
</pre>

<p>
Then configure <code>~/.procmailrc</code>:
</p>

<p>
I found a detailed tutorial <a href="https://groups.csail.mit.edu/mac/ftpdir/users/mrb/Hacks/ELisp/Spam/spambnc.proctut.shtml">here</a>. And this is the <a href="http://archive.is/OTMaa">archived link</a> in case the original broke.
</p>

<pre class="example">
SHELL=/bin/sh
PATH=/usr/sbin:/usr/bin:/usr/local/sbin:/usr/local/bin
MAILDIR=$HOME/Mail/
LOGFILE=$HOME/.procmail.log
VERBOSE=yes
DEFAULT=$MAILDIR/inbox/
</pre>
</div>
</div>
</div>

<div id="outline-container-update:-Use-%3Ccode%3Embsync%3C/code%3E-(%3Ccode%3Eisync%3C/code%3E)-to-Download-Mails" class="outline-3">
<h3 id="update:-Use-%3Ccode%3Embsync%3C/code%3E-(%3Ccode%3Eisync%3C/code%3E)-to-Download-Mails"><span class="section-number-3">3.4</span> Update: Use <code>mbsync</code> (<code>isync</code>) to Download Mails</h3>
<div class="outline-text-3" id="text-3-4">
<p>
It seems <code>mbsync</code> is faster and easier to configure.
</p>

<p>
Here is <a href="http://isync.sourceforge.net/mbsync.html">the manual</a>.
</p>

<p>
Configure <code>~/.mbsyncrc</code>:
</p>

<pre class="example">
IMAPAccount gmail
# Address to connect to
Host imap.gmail.com
User user@gmail.com
Pass password
# To store the password in an encrypted file use PassCmd instead of Pass
# PassCmd "gpg2 -q --for-your-eyes-only --no-tty -d ~/.mailpass.gpg"
#
# Use SSL
SSLType IMAPS
AuthMechs LOGIN

# The following line should work. If get certificate errors, uncomment the two following lines and read the "Troubleshooting" section.
# CertificateFile /etc/ssl/certs/ca-certificates.crt
#CertificateFile ~/.cert/imap.gmail.com.pem
#CertificateFile ~/.cert/Equifax_Secure_CA.pem

IMAPStore gmail-remote
Account gmail

MaildirStore gmail-local
Path ~/Mail/Gmail/
SubFolders Verbatim
Inbox ~/Mail/Gmail/Inbox

Channel gmail
Master :gmail-remote:
Slave :gmail-local:
# Exclude everything under the internal [Gmail] folder, except the interesting folders
Patterns * ![Gmail]* "[Gmail]/Sent Mail" "[Gmail]/Starred" "[Gmail]/All Mail"
# Or include everything
#Patterns *
# Automatically create missing mailboxes, both locally and on the server
Create Both
# Save the synchronization state files in the relevant directory
SyncState *


IMAPAccount psu
Host outlook.office365.com
User user@psu.edu
Pass password
SSLType IMAPS
AuthMechs LOGIN

IMAPStore psu-remote
Account psu

MaildirStore psu-local
Path ~/Mail/PSU/
SubFolders Verbatim
Inbox ~/Mail/PSU/Inbox

Channel psu
Master :psu-remote:
Slave :psu-local:
Patterns "Archive" "Sent Items"
Create Both
SyncState *
</pre>

<p>
Most of the stuff can be found in manual. If you are not sure what folders there are, you can set <code>Pattern</code> to <code>*</code> and retrieve everything. Once you know the name for each folder, you can set specific rules to get only the ones you want.
</p>

<p>
Note that mbsync is sensitive to empty lines. You got to keep each "block" together.
</p>

<p>
Fetch your mail by <code>mbsync &lt;account&gt;</code>, e.g. <code>mbsync gmail</code> or <code>mbsync psu</code>. You can set a corn job (linux) or launchd job (macOS) to run it periodically.
</p>
</div>

<div id="outline-container-Use-a-Password-File-instead-of-plain-text" class="outline-4">
<h4 id="Use-a-Password-File-instead-of-plain-text"><span class="section-number-4">3.4.1</span> Use a Password File instead of plain text</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
Currently the password of my email account is just lying in the <code>.mbsyncrc</code>, which makes me a bit uncomfortable and I can't put it under (public) version control. However, the tutorial that I based my config on already gave a solution: use a password file.
</p>

<p>
This way I can manage my config with git, cool.
</p>

<p>
So the concept is basically create a file with password, encrypt it with gpg, when <code>mbsync</code> needs password, it runs gpg to decrypt the password.
</p>

<p>
I created <code>gmailpass</code> with my Gmail password in it. Then encrypted it with
</p>

<div class="org-src-container">
<pre class="src src-shell">gpg -c gmailpass
</pre>
</div>

<p>
If you have gpg setup correclty, it should ask you for a password, I just repeated the Gmail password at here because I'm lazy. Then you'll get a <code>gmaipass.gpg</code> file, that's your encrypted password file. Now you can delete the plain text <code>gmailpass</code>.
</p>

<p>
Then set PassCmd in <code>~/.mbsyncrc</code>:
</p>

<pre class="example">
IMAPAccount gmail
# Address to connect to
Host imap.gmail.com
User casouri@gmail.com
# To store the password in an encrypted file use PassCmd instead of Pass
PassCmd "gpg -q --for-your-eyes-only --no-tty -d ~/gmailpass.gpg"
</pre>

<p>
If you run that command <code>gpg -q --for-your-eyes-only --no-tty -d ~/gmailpass.gpg</code>, the password is actually printed back, so you can guess how does that work.
</p>

<p>
Now you can put <code>~/.mbsyncrc</code> and password file in your config repo safely.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-Folder-Buffer" class="outline-2">
<h2 id="Folder-Buffer"><span class="section-number-2">4</span> Folder Buffer</h2>
<div class="outline-text-2" id="text-4">
<p>
Once you start up WL with <code>M-x wl</code> and entered your password, you are in folder mode:
</p>

<pre class="example">
[-]Desktop:0/0/307
  [-]GMAIL :0/0/307
    Inbox:0/0/2
    All Mail:0/0/0
    Sent:0/0/304
    Starred:0/0/1
    Draft:0/0/0
    Trash:0/0/0
</pre>

<p>
A couple bindings:
</p>

<dl class="org-dl">
<dt><code>n/p</code></dt><dd>move down/up</dd>
<dt><code>N/P</code></dt><dd>next/last folder with unread mail</dd>
<dt><code>q</code></dt><dd>quit WL</dd>
<dt><code>z</code></dt><dd>suspend WL</dd>
<dt><code>RET/SPC</code></dt><dd>open a folder and go to summary mode</dd>
<dt><code>c</code></dt><dd>mark all mail as read</dd>
<dt><code>M-RET</code></dt><dd>toggle child</dd>
<dt><code>[</code></dt><dd>expand all folders</dd>
<dt><code>]</code></dt><dd>collapse all folders</dd>
<dt><code>'</code></dt><dd>quick search</dd>
</dl>

<p>
For more bindings, checkout <a href="http://wanderlust.github.io/wl-docs/wl.html#Folder">the manual</a>.
</p>
</div>
</div>

<div id="outline-container-Summary-Buffer" class="outline-2">
<h2 id="Summary-Buffer"><span class="section-number-2">5</span> Summary Buffer</h2>
<div class="outline-text-2" id="text-5">
<p>
Here you see all your mails:
</p>

<pre class="example">
377  09/16(Wed)11:57 [+1: Takuro Kitame  ] Bug?
381  09/17(Thu)00:16 [+3: Fujikazu Okuni ] elmo-lha.el -- LHA interface
384  09/17(Thu)01:32 [+1: Yuuichi Terani ] wl-0.6.2
389 N09/18(Fri)01:07 [+2: Yuuichi Terani ] wl-0.6.3
</pre>

<p>
The columns are: Message number, Temporal mark, Persistent mark, Date, Sender, Subject.
</p>

<p>
Bindings:
</p>

<dl class="org-dl">
<dt><code>l</code></dt><dd>Toggle folder buffer in the left.</dd>
<dt><code>v</code></dt><dd>toggle display of message window. I found this important&#x2026;</dd>
<dt><code>n/p</code></dt><dd>move down/up</dd>
<dt><code>N/P</code></dt><dd>next/last unread mail</dd>
<dt><code>*</code></dt><dd>mark</dd>
<dt><code>u</code></dt><dd>unmark</dd>
<dt><code>U</code></dt><dd>unmark all</dd>
<dt><code>q</code></dt><dd>go back</dd>
<dt><code>SPC/RET</code></dt><dd>view mail, you can still use <code>n/p</code> to go through mails. Keep tapping <code>SPC</code> to go through all unread mails.</dd>
<dt><code>s</code></dt><dd>refresh</dd>
<dt><code>/</code></dt><dd>toggle thread(conversation)</dd>
<dt><code>[/]</code></dt><dd>expand/collapse all thread</dd>
<dt><code>a</code></dt><dd>reply</dd>
<dt><code>f</code></dt><dd>forward</dd>
<dt><code>$</code></dt><dd>toggle <code>important</code> flag</dd>
<dt><code>w</code></dt><dd>new draft</dd>
<dt><code>q</code></dt><dd>quit WL</dd>
<dt><code>z</code></dt><dd>suspend WL</dd>
<dt><code>Z</code></dt><dd>sync with address book</dd>
<dt><code>!</code></dt><dd>Mark as unread</dd>
<dt><code>S</code></dt><dd>Sort</dd>
<dt><code>R</code></dt><dd>Mark as read</dd>
<dt><code>o</code></dt><dd>put refile mark</dd>
<dt><code>O</code></dt><dd>put copy mark</dd>
<dt><code>C-o</code></dt><dd>autorefile</dd>
<dt><code>d</code></dt><dd>put dispose mark, the result of disposal is controlled by <code>wl-dispose-folder-alist</code>.</dd>
<dt><code>@</code></dt><dd>add/remove/change sender to/from/in address book</dd>
<dt><code>'</code></dt><dd>quick search</dd>
</dl>

<p>
More in <a href="http://wanderlust.github.io/wl-docs/wl.html#Key-Bindings-of-Summary">the manual</a>
</p>
</div>

<div id="outline-container-Format-of-summary-lines" class="outline-4">
<h4 id="Format-of-summary-lines"><span class="section-number-4">5.0.1</span> Format of summary lines</h4>
<div class="outline-text-4" id="text-5-0-1">
<p>
<a href="http://wanderlust.github.io/wl-docs/wl.html#Summary-View">manual</a>
</p>
</div>
</div>

<div id="outline-container-Message-Buffer" class="outline-3">
<h3 id="Message-Buffer"><span class="section-number-3">5.1</span> Message Buffer</h3>
<div class="outline-text-3" id="text-5-1">
<dl class="org-dl">
<dt><code>l</code></dt><dd>toggle display of summary buffer on the top</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-Send-Mail" class="outline-2">
<h2 id="Send-Mail"><span class="section-number-2">6</span> Send Mail</h2>
<div class="outline-text-2" id="text-Send-Mail">
</div>
<div id="outline-container-Configure" class="outline-3">
<h3 id="Configure"><span class="section-number-3">6.1</span> Configure</h3>
<div class="outline-text-3" id="text-6-1">
<p>
I have two email address, this way I can chose which address I send mails from. Hit <code>C-c C-j</code> in message mode to chose.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">default template</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-smtp-connection-type 'starttls
      wl-smtp-posting-port 587
      wl-smtp-authenticate-type <span style="color: #489446;">"plain"</span>
      wl-smtp-posting-user <span style="color: #489446;">"casouri"</span>
      wl-smtp-posting-server <span style="color: #489446;">"smtp.gmail.com"</span>
      wl-local-domain <span style="color: #489446;">"gmail.com"</span>
      wl-message-id-domain <span style="color: #489446;">"smtp.gmail.com"</span><span style="color: #2C79F5;">)</span>
<span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">multi address</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-user-mail-address-list '<span style="color: #A8289C;">(</span><span style="color: #489446;">"casouri@gmail.com"</span> <span style="color: #489446;">"ykf5041@psu.edu"</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-template-alist
      '<span style="color: #A8289C;">(</span><span style="color: #489446;">(</span><span style="color: #489446;">"GMAIL"</span>
         <span style="color: #DA7A48;">(</span>wl-from . <span style="color: #489446;">"Yuan Fu <a href="mailto:casouri%40gmail.com">&lt;casouri@gmail.com&gt;</a>"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-posting-user . <span style="color: #489446;">"casouri"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-posting-server . <span style="color: #489446;">"smtp.gmail.com"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-authenticate-type .<span style="color: #489446;">"plain"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-connection-type . 'starttls<span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-posting-port . 587<span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-local-domain . <span style="color: #489446;">"gmail.com"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-message-id-domain . <span style="color: #489446;">"smtp.gmail.com"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span><span style="color: #489446;">"From"</span> . wl-from<span style="color: #DA7A48;">)</span><span style="color: #489446;">)</span>
        <span style="color: #489446;">(</span><span style="color: #489446;">"PSU"</span>
         <span style="color: #DA7A48;">(</span>wl-from . <span style="color: #489446;">"Yuan Fu <a href="mailto:ykf5041%40psu.edu">&lt;ykf5041@psu.edu&gt;</a>"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-posting-user . <span style="color: #489446;">"ykf5041@psu.edu"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-authenticate-type .<span style="color: #489446;">"login"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-posting-server . <span style="color: #489446;">"smtp.office365.com"</span><span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-connection-type . 'starttls<span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>wl-smtp-posting-port . 587<span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span><span style="color: #489446;">"From"</span> . wl-from<span style="color: #DA7A48;">)</span><span style="color: #489446;">)</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>
</pre>
</div>

<p>
You got to set the default config. By default WL doesn't apply any template. Templates are kind of like color themes in Emacs, all they do is override.
</p>

<p>
Note that I set <code>wl-smtp-authenticate-type</code> to <code>"login"</code> in Outlook mail (Penn State uses Outlook).
</p>
</div>
</div>

<div id="outline-container-Write-Mail" class="outline-3">
<h3 id="Write-Mail"><span class="section-number-3">6.2</span> Write Mail</h3>
<div class="outline-text-3" id="text-6-2">
<p>
Hit <code>w</code> to start a Draft buffer and go into message mode.
</p>

<p>
Bindings:
</p>

<dl class="org-dl">
<dt><code>C-c C-j</code></dt><dd>switch between from addresses</dd>
<dt><code>C-c C-k</code></dt><dd>kill draft</dd>
<dt><code>C-c TAB</code></dt><dd>add attachment</dd>
<dt><code>C-c C-c</code></dt><dd>send and exit</dd>
<dt><code>C-c C-z</code></dt><dd>save and exit</dd>
<dt><code>C-c C-w</code></dt><dd>signature</dd>
<dt><code>C-c C-t</code></dt><dd>start editing text</dd>
<dt><code>C-c C-f</code></dt><dd>cc and friends</dd>
</dl>
</div>
</div>

<div id="outline-container-Dynamic-Modification-of-Messages" class="outline-3">
<h3 id="Dynamic-Modification-of-Messages"><span class="section-number-3">6.3</span> Dynamic Modification of Messages</h3>
<div class="outline-text-3" id="text-6-3">
<p>
For example:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">Use the same address to reply</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-draft-config-alist
      '<span style="color: #A8289C;">(</span><span style="color: #489446;">(</span><span style="color: #DA7A48;">(</span>string-match <span style="color: #489446;">"psu"</span> wl-draft-parent-folder<span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>template . <span style="color: #489446;">"PSU"</span><span style="color: #DA7A48;">)</span><span style="color: #489446;">)</span>
        <span style="color: #489446;">(</span><span style="color: #DA7A48;">(</span>string-match <span style="color: #489446;">"gmail"</span> wl-draft-parent-folder<span style="color: #DA7A48;">)</span>
         <span style="color: #DA7A48;">(</span>template . <span style="color: #489446;">"GMAIL"</span><span style="color: #DA7A48;">)</span><span style="color: #489446;">)</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>
</pre>
</div>

<p>
This makes sure I always reply with the address to which the mail was send.
</p>

<p>
BTW, if it doesn't appear to work, it's because it applies when the mail is sent, as the docstring of <code>wl-draft-config-alist</code> says:
</p>
<blockquote>
<p>
The configuration is applied when ‘wl-draft-config-exec’ is called, or applied automatically before sending message.
</p>
</blockquote>

<p>
The format of <code>wl-draft-config-alist</code> is:
</p>

<pre class="example">
'(("regexp of the header" or elisp expression
  ("Field" . value(elisp expression))
   (variable . value(elisp expression))
   (sub-function . value(elisp expression))
   function
   …)
  ("regexp of the header" or elisp expression
   ("Field" . value(elisp expression))
   …))
</pre>

<p>
Per default, there are 13 following sub-functions.
</p>

<pre class="example">
'header:      Inserts the specified string at the bottom of the header.
'header-top:  Inserts the specified string at the top of the header.
'header-file: Inserts the specified file at the bottom of the header.
'x-face:      Inserts ‘X-Face:’ field with the content of the specified file.
'top:         Inserts the specified string at the top of the body.
'top-file:    Inserts the specified file at the top of the body.
'body:        Replaces the body with the specified string.
              Specifying nil deletes the entire body string.
'body-file:   Replaces the body with the content of the specified file.
'bottom:      Inserts the specified string at the bottom of the body.
'bottom-file: Inserts the specified file at the top of the body.
'part-top:  Inserts the specified string at the top of the current part.
'part-bottom: Inserts the specified string at the bottom of the current part.
'template:    Applies the specified template.
              (refer to the next subsection)
</pre>

<p>
More in [[<a href="http://wanderlust.github.io/wl-docs/wl.html#Dynamical-Message-Re_002darrangement">http://wanderlust.github.io/wl-docs/wl.html#Dynamical-Message-Re_002darrangement</a>][the manual]
</p>
</div>
</div>
</div>

<div id="outline-container-Address-Book" class="outline-2">
<h2 id="Address-Book"><span class="section-number-2">7</span> Address Book</h2>
<div class="outline-text-2" id="text-Address-Book">
</div>
<div id="outline-container-%3Ccode%3Ebbdb%3C/code%3E-as-Address-Book" class="outline-3">
<h3 id="%3Ccode%3Ebbdb%3C/code%3E-as-Address-Book"><span class="section-number-3">7.1</span> <code>bbdb</code> as Address Book</h3>
<div class="outline-text-3" id="text-7-1">
<p>
<code>bbdb-v3</code> supports Wanderlust directly. Get it from <a href="http://download.savannah.nongnu.org/releases/bbdb/">savannah</a>.
</p>

<p>
<a href="https://www.emacswiki.org/emacs/BBDBV3-Wl">Emacs Wiki</a> has a tutorial for <code>bbdb-v3</code> setup for Wanderlust.
<a href="http://emacs-fu.blogspot.com/2009/08/managing-e-mail-addresses-with-bbdb.html">Emacs-fu</a> also got a detailed tutorial, but his setup is for <code>bbdb-v2</code>. I'll mention the different parts below.
</p>

<p>
I copied most part from emacs-fu with slight changes:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">before load</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> bbdb-file <span style="color: #A8289C;">(</span>concat moon-star-dir <span style="color: #489446;">"utility/email/bbdb"</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>

<span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">after load</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">require</span> '<span style="color: #A8289C;">bbdb-wl</span><span style="color: #2C79F5;">)</span>
<span style="color: #2C79F5;">(</span>bbdb-initialize 'wl<span style="color: #2C79F5;">)</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span>
 bbdb-wl-folder-regexp    <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">get addresses only from these folders</span>
 <span style="color: #489446;">"^</span><span style="color: #987816;">\</span><span style="color: #489446;">.inbox$</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">^.sent"</span><span style="color: #2C79F5;">)</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span>
 bbdb-offer-save 1                        <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">1 means save-without-asking</span>

 bbdb-use-pop-up t                        <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">allow popups for addresses</span>
 bbdb-electric-p t                        <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">be disposable with SPC</span>
 bbdb-popup-target-lines  1               <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">very small</span>

 bbdb-dwim-net-address-allow-redundancy t <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">always use full name</span>
 bbdb-quiet-about-name-mismatches 2       <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">show name-mismatches 2 secs</span>

 bbdb-always-add-address t                <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">add new addresses to existing...</span>
 <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">...contacts automatically</span>
 bbdb-canonicalize-redundant-nets-p t     <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">x@foo.bar.cx =&gt; x@bar.cx</span>

 bbdb-completion-type nil                 <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">complete on anything</span>

 bbdb-complete-name-allow-cycling t       <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">cycle through matches</span>
 <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">this only works partially</span>

 bbbd-message-caching-enabled t           <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">be fast</span>
 bbdb-use-alternate-names t               <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">use AKA</span>


 bbdb-elided-display t                    <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">single-line addresses</span>

 <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">auto-create addresses from mail</span>
 bbdb/mail-auto-create-p 'bbdb-ignore-some-messages-hook

 <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">don't ask about fake addresses</span>
 <span style="color: #9a9ea2;">;; </span>NOTE<span style="color: #9a9ea2;">: there can be only one entry per header (such as To, From)</span>
 <span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">http://flex.ee.uec.ac.jp/texi/bbdb/bbdb_11.html</span>
 bbdb-ignore-some-messages-alist
 '<span style="color: #A8289C;">(</span><span style="color: #489446;">(</span> <span style="color: #489446;">"From"</span> . <span style="color: #489446;">"no.?reply</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">DAEMON</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">daemon</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">facebookmail</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">twitter"</span><span style="color: #489446;">)</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>
</pre>
</div>

<p>
And in <code>.wl</code>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2C79F5;">(</span><span style="color: #E04E49;">require</span> '<span style="color: #A8289C;">bbdb</span><span style="color: #2C79F5;">)</span>
</pre>
</div>


<p>
To make it work for <code>bbdb-v3</code>:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2C79F5;">(</span><span style="color: #E04E49;">require</span> '<span style="color: #A8289C;">bbdb-wl</span><span style="color: #2C79F5;">)</span>
<span style="color: #2C79F5;">(</span>bbdb-initialize 'wl<span style="color: #2C79F5;">)</span>
</pre>
</div>

<p>
There is also <a href="https://blog.anupamsg.me/2009/08/16/importing-contacts-from-osx-addressbook-to-emacs-bbdb/">this tutorial</a> on how to import mac contacts into bbdb, I just don't bother.
</p>
</div>
</div>

<div id="outline-container-Built-in" class="outline-3">
<h3 id="Built-in"><span class="section-number-3">7.2</span> Built in</h3>
<div class="outline-text-3" id="text-7-2">
<p>
You can use the built in address book, I don't.
</p>

<p>
Hit <code>C-c C-a</code> to go into address manager, in address manager:
</p>

<dl class="org-dl">
<dt><code>c</code></dt><dd>add CC: mark</dd>
<dt><code>t</code></dt><dd>add To: mark</dd>
<dt><code>b</code></dt><dd>add Bcc: mark</dd>
<dt><code>u</code></dt><dd>cancel the marker</dd>
<dt><code>a</code></dt><dd>add entry</dd>
<dt><code>e</code></dt><dd>edit entry</dd>
<dt><code>d</code></dt><dd>delete entry</dd>
</dl>


<p>
In summary mode use <code>@</code> to add/remove/change sender to/from/in address book.
</p>

<p>
<a href="http://wanderlust.github.io/wl-docs/wl.html#Address-Book">manual</a>
</p>
</div>
</div>
</div>

<div id="outline-container-Search-Mail" class="outline-2">
<h2 id="Search-Mail"><span class="section-number-2">8</span> Search Mail</h2>
<div class="outline-text-2" id="text-8">
<p>
You can use <code>notmuch</code> as a searching backend. To use <code>notmuch</code>:
</p>

<p>
Set:
</p>

<pre class="example">
(setq wl-quicksearch-folder "[]")
(setq elmo-search-default-engine 'notmuch)

</pre>

<p>
And download <code>notmuch</code> and set it up by <code>notmuch new</code>.
</p>

<p>
Then hit <code>'</code> to start a quick search.
</p>

<p>
Here is all the available <code>notmuch</code> searching patterns: <a href="https://notmuchmail.org/searching/">manual</a>.
</p>
</div>
</div>

<div id="outline-container-Auto-Refile" class="outline-2">
<h2 id="Auto-Refile"><span class="section-number-2">9</span> Auto Refile</h2>
<div class="outline-text-2" id="text-9">
<p>
<a href="http://wanderlust.github.io/wl-docs/wl.html#Auto-Refile">manual</a>
</p>
</div>
</div>

<div id="outline-container-Expire-rules" class="outline-2">
<h2 id="Expire-rules"><span class="section-number-2">10</span> Expire rules</h2>
<div class="outline-text-2" id="text-10">
<p>
The expire rules are based on folders, you specific a time to expire and a destination of expiration, usually trash folder or simply remove.
</p>

<p>
But what if we don't want to expire the whole buffer? You have <a href="http://wanderlust.github.io/wl-docs/wl.html#Filter-Folder">filter folders</a> to the rescue :)
</p>

<p>
<a href="http://wanderlust.github.io/wl-docs/wl.html#Expire">expire manual</a>
</p>

<p>
Example:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #9a9ea2;">;; </span><span style="color: #9a9ea2;">expire</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-expire-alist
      `<span style="color: #A8289C;">(</span><span style="color: #489446;">(</span>,<span style="color: #DA7A48;">(</span>concat <span style="color: #489446;">"/cc:emacs-devel@gnu.org/"</span> <span style="color: #A8289C;">(</span>regexp-quote <span style="color: #489446;">".~/Mail/Gmail/Inbox"</span><span style="color: #A8289C;">)</span><span style="color: #DA7A48;">)</span> <span style="color: #DA7A48;">(</span>date 7<span style="color: #DA7A48;">)</span> trash<span style="color: #489446;">)</span>
        <span style="color: #489446;">(</span>,<span style="color: #DA7A48;">(</span>regexp-quote <span style="color: #489446;">".~/Mail/Gmail/[Gmail]/Trivial"</span><span style="color: #DA7A48;">)</span> <span style="color: #DA7A48;">(</span>date 14<span style="color: #DA7A48;">)</span> trash<span style="color: #489446;">)</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-Other" class="outline-2">
<h2 id="Other"><span class="section-number-2">11</span> Other</h2>
<div class="outline-text-2" id="text-Other">
</div>
<div id="outline-container-Save-password" class="outline-3">
<h3 id="Save-password"><span class="section-number-3">11.1</span> Save password</h3>
<div class="outline-text-3" id="text-11-1">
<p>
Once you entered password, run <code>elmo-passwd-alis-save</code> to save password in=~/.elmo/passwd=. The password is encrypted so don't worry.
</p>
</div>
</div>

<div id="outline-container-Ignore-Crap-in-Header" class="outline-3">
<h3 id="Ignore-Crap-in-Header"><span class="section-number-3">11.2</span> Ignore Crap in Header</h3>
<div class="outline-text-3" id="text-11-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-message-ignored-field-list
      '<span style="color: #A8289C;">(</span><span style="color: #489446;">"."</span><span style="color: #A8289C;">)</span>
      wl-message-visible-field-list
      '<span style="color: #A8289C;">(</span><span style="color: #489446;">"^</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">(</span><span style="color: #489446;">To</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">Cc</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">)</span><span style="color: #489446;">:"</span>
        <span style="color: #489446;">"^Subject:"</span>
        <span style="color: #489446;">"^</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">(</span><span style="color: #489446;">From</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">Reply-To</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">)</span><span style="color: #489446;">:"</span>
        <span style="color: #489446;">"^</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">(</span><span style="color: #489446;">Posted</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">Date</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">)</span><span style="color: #489446;">:"</span>
        <span style="color: #489446;">"^Organization:"</span>
        <span style="color: #489446;">"^X-</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">(</span><span style="color: #489446;">Face</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">(</span><span style="color: #489446;">-[0-9]+</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">)</span><span style="color: #489446;">?</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">Weather</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">Fortune</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">|</span><span style="color: #489446;">Now-Playing</span><span style="color: #2C79F5;">\\</span><span style="color: #2C79F5;">)</span><span style="color: #489446;">:"</span><span style="color: #A8289C;">)</span>
      wl-message-sort-field-list
      <span style="color: #A8289C;">(</span>append wl-message-sort-field-list
              '<span style="color: #489446;">(</span><span style="color: #489446;">"^Reply-To"</span> <span style="color: #489446;">"^Posted"</span> <span style="color: #489446;">"^Date"</span> <span style="color: #489446;">"^Organization"</span><span style="color: #489446;">)</span><span style="color: #A8289C;">)</span><span style="color: #2C79F5;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-Show-folders-in-Summary-Buffer" class="outline-3">
<h3 id="Show-folders-in-Summary-Buffer"><span class="section-number-3">11.3</span> Show folders in Summary Buffer</h3>
<div class="outline-text-3" id="text-11-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-stay-folder-window t<span style="color: #2C79F5;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-X-Face" class="outline-3">
<h3 id="X-Face"><span class="section-number-3">11.4</span> X-Face</h3>
<div class="outline-text-3" id="text-11-4">
<p>
Download x-face-e21.el from <a href="http://www.jpl.org/ftp/pub/elisp/">http://www.jpl.org/ftp/pub/elisp/</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2C79F5;">(</span>autoload 'x-face-decode-message-header <span style="color: #489446;">"x-face-e21"</span><span style="color: #2C79F5;">)</span>
<span style="color: #2C79F5;">(</span><span style="color: #E04E49;">setq</span> wl-highlight-x-face-function 'x-face-decode-message-header<span style="color: #2C79F5;">)</span>
</pre>
</div>

<p>
As long as <code>wl-x-face-file</code> exists, WL automatically insert X-Face into header. You can control this behavior by <code>wl-auto-insert-x-face</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-Funny-Quote" class="outline-2">
<h2 id="Funny-Quote"><span class="section-number-2">12</span> Funny Quote</h2>
<div class="outline-text-2" id="text-12">
<p>
From <a href="http://emacs-fu.blogspot.com/2009/06/e-mail-with-wanderlust.html">here</a>:
</p>

<blockquote>
<p>
It's a particulary nice setup for offline-usage: whenever there's a network connection, I suck up all the mails and have them available offline.
</p>
</blockquote>

<p>
From <a href="http://mihai.bazon.net/articles/emacs/wanderlust-email-client">here</a>:
</p>

<blockquote>
<p>
Wanderlust (WL) is an email client for Emacs.  I stumbled upon it in my never ending search for an email client that doesn't suck.  Wanderlust does suck, God it does! — but I'm using it for a few days and I was tricked to think that it sucks less than others.
</p>
</blockquote>

<blockquote>
<p>
WL, like other Emacs-based email clients, is not for everyone.  Before you get into it, I think you should ask yourself two questions:
</p>

<p>
Are you an Emacs user? Do you think that all email clients suck? If you answer “yes” to exactly one of these questions, you might want to give WL a chance.  “Yes” to both questions means that WL is just what you're looking for.  If your answer is “no” to both questions, save yourself some time and stop reading now. ;-)
</p>
</blockquote>
</div>
</div>
]]></description>
<pubDate>Fri, 28 Sep 2018 00:00:00 -0400</pubDate>
</item>
